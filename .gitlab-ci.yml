stages:
  - build

build:
  stage: build
  image: fedora:37
  variables:
    SSH_USER: admin
    SSH_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
    SSH_HOST: 192.168.1.39
  script:
    - dnf install wget openssh-clients -y
    - wget https://raw.githubusercontent.com/tosin2013/qubinode_navigator/main/setup.sh -P /tmp/
    - chmod +x /tmp/setup.sh
    - mkdir -p ~/.ssh/
    - echo "$SSH_KEY" | tr -d '\r' > ~/.ssh/id_rsa
    - chmod 600 ~/.ssh/id_rsa
    - cat  ~/.ssh/id_rsa
    - ssh "$SSH_USER"@"$SSH_HOST" hostnamectl # 'bash -s' < /tmp/setup.sh
  only:
    - main
