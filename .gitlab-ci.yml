stages:
  - build

build:
  stage: build
  image: fedora:37
  variables:
    SSH_USER: admin
    SSH_PASS: XXXXX
    SSH_HOST: 192.168.1.39
  script:
    - dnf install wget sshpass -y
    - sshpass -h
    - wget https://raw.githubusercontent.com/tosin2013/qubinode_navigator/main/setup.sh
    - mv setup.sh /tmp/ && chmod +x /tmp/setup.sh
    - echo  SSHPASS="$SSH_PASS" sshpass -e ssh "$SSH_USER"@"$SSH_HOST" date
    - SSHPASS="$SSH_PASS" sshpass -e ssh "$SSH_USER"@"$SSH_HOST" date
    - SSHPASS="$SSH_PASS" sshpass -e ssh "$SSH_USER"@"$SSH_HOST" "mkdir -p /tmp"
    - sshpass -p "$SSH_PASS" scp setup.sh "$SSH_USER"@"$SSH_HOST":/tmp/
    - SSHPASS="$SSH_PASS" sshpass -e ssh "$SSH_USER"@"$SSH_HOST" "chmod +x /tmp/setup.sh && /tmp/setup.sh"
  only:
    - main
