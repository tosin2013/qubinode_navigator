# Apache Airflow Configuration for Qubinode Navigator
# Phase 6 Goal 2: Workflow Orchestration Integration
# Based on: ADR-0036, ADR-0037

# ============================================================================
# Feature Flag - Set to 'true' to enable Airflow integration
# ============================================================================
ENABLE_AIRFLOW=true

# ============================================================================
# Airflow Core Configuration
# ============================================================================
AIRFLOW_HOME=/opt/airflow
AIRFLOW__CORE__DAGS_FOLDER=/opt/airflow/dags
AIRFLOW__CORE__PLUGINS_FOLDER=/opt/airflow/plugins
AIRFLOW__CORE__BASE_LOG_FOLDER=/opt/airflow/logs
AIRFLOW__CORE__EXECUTOR=LocalExecutor
AIRFLOW__CORE__LOAD_EXAMPLES=False
AIRFLOW__CORE__LOAD_DEFAULT_CONNECTIONS=True
AIRFLOW__CORE__PARALLELISM=32
AIRFLOW__CORE__MAX_ACTIVE_RUNS_PER_DAG=16

# ============================================================================
# Database Configuration
# ============================================================================
AIRFLOW__DATABASE__SQL_ALCHEMY_CONN=postgresql+psycopg2://airflow:airflow@postgres:5432/airflow
AIRFLOW__DATABASE__SQL_ALCHEMY_POOL_SIZE=5
AIRFLOW__DATABASE__SQL_ALCHEMY_MAX_OVERFLOW=10

# ============================================================================
# Webserver Configuration
# ============================================================================
AIRFLOW__WEBSERVER__WEB_SERVER_PORT=8888
AIRFLOW__WEBSERVER__WEB_SERVER_HOST=0.0.0.0
AIRFLOW__WEBSERVER__SECRET_KEY=CHANGE_THIS_IN_PRODUCTION
AIRFLOW__WEBSERVER__AUTHENTICATE=True
AIRFLOW__WEBSERVER__AUTH_BACKEND=airflow.api.auth.backend.basic_auth
AIRFLOW__WEBSERVER__EXPOSE_CONFIG=True
AIRFLOW__WEBSERVER__RBAC=True

# ============================================================================
# API Configuration
# ============================================================================
AIRFLOW__API__AUTH_BACKENDS=airflow.api.auth.backend.basic_auth
AIRFLOW__API__ENABLE_EXPERIMENTAL_API=False

# ============================================================================
# Scheduler Configuration
# ============================================================================
AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL=30
AIRFLOW__SCHEDULER__CATCHUP_BY_DEFAULT=False
AIRFLOW__SCHEDULER__MAX_THREADS=2

# ============================================================================
# Logging Configuration
# ============================================================================
AIRFLOW__LOGGING__BASE_LOG_FOLDER=/opt/airflow/logs
AIRFLOW__LOGGING__LOGGING_LEVEL=INFO
AIRFLOW__LOGGING__FAB_LOGGING_LEVEL=WARNING
AIRFLOW__LOGGING__COLORED_CONSOLE_LOG=True

# ============================================================================
# Qubinode Navigator Integration
# ============================================================================
QUBINODE_AI_ASSISTANT_URL=http://localhost:8000
QUBINODE_KCLI_ENABLED=true
QUBINODE_RAG_INTEGRATION=true

# ============================================================================
# Git-Sync Configuration (ADR-0037)
# ============================================================================
GIT_SYNC_ENABLED=false
GIT_SYNC_REPO=
GIT_SYNC_BRANCH=main
GIT_SYNC_DEPTH=1
GIT_SYNC_WAIT=60

# ============================================================================
# PostgreSQL Database Configuration
# ============================================================================
POSTGRES_USER=airflow
POSTGRES_PASSWORD=airflow
POSTGRES_DB=airflow
POSTGRES_PORT=5432

# ============================================================================
# Security Notes
# ============================================================================
# IMPORTANT:
# - Change AIRFLOW__WEBSERVER__SECRET_KEY in production
# - Change POSTGRES_PASSWORD in production
# - Enable HTTPS for production deployments
# - Configure proper authentication backend for production
