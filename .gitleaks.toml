# Gitleaks Configuration for Qubinode Navigator
# Uses default gitleaks rules with project-specific allowlists
#
# Reference: https://github.com/gitleaks/gitleaks#configuration

title = "Qubinode Navigator Security Scan"

# Use default gitleaks rules (detects real secrets like API keys, private keys, etc.)
[extend]
useDefault = true

# Global allowlist for known false positives
[allowlist]
description = "Allowlist for Qubinode Navigator false positives"

# Paths to completely ignore
paths = [
    # Example and template files
    '''.env.example''',
    '''.env.mcp''',
    '''inventories/sample/.*''',
    '''mcp-client-config-example.json''',
    # Documentation (contains example API keys for illustration)
    '''docs/.*''',
    '''.*\.md$''',
    '''MCP-.*\.md$''',
    # Test files
    '''tests/.*''',
    '''.*_test\.py$''',
    '''test_.*\.py$''',
    # Scripts with example patterns
    '''scripts/setup-security-tools.sh''',
    '''scripts/security-scan.sh''',
    '''scripts/cleanup-git-history.sh''',
    '''deploy-fastmcp-production.sh''',
]

# Regex patterns to ignore in detected matches
regexTarget = "match"
regexes = [
    # Placeholder/example values
    '''CHANGEME''',
    '''your[-_].*''',
    '''example''',
    '''placeholder''',
    '''template''',
    '''sample''',
    # Variable substitutions (not real secrets)
    '''\$\{.*\}''',
    '''\$[A-Z_]+''',
    # Localhost references (not sensitive)
    '''localhost''',
    '''127\.0\.0\.1''',
    '''0\.0\.0\.0''',
    # Known development/sample passwords
    '''Harbor12345''',
    '''testpass''',
    '''adminpass''',
    '''airflow:airflow''',
    '''user:pass''',
    # Known dev API keys (local development only)
    '''b8c909cc21b988703db529ff2287cdbe0cc3ffca67678e9c97bd912790df6486''',
    # Template patterns with mustache/jinja syntax
    '''\{\{.*\}\}''',
]

# Specific commit allowlist (for historical commits with known issues)
commits = []

# Stopwords that indicate the value is not a real secret
stopwords = [
    "example",
    "sample",
    "test",
    "placeholder",
    "changeme",
    "your-password",
    "your_password",
]
